%oldp = [0.009,0.99,0.001];
oldp = [0.2,0.6,0.2];
%oldp = [0.18,0.6,0.22];
%oldp = [0.2,0.5,0.3];
%oldp = [1/3,1/3,1/3];
%oldp = [1/4,1/2,1/4];
%oldp = [1/4,1/4,1/2];
%advantage = [1, -1, -1];
%advantage = [-1, -1, 1];
advantage = [-1, -1, 1];
%advw = [ 1, 1, 4 ];
advw = [ 1, 1, 1 ];
epsilon = 0.1;
%pitheta0 = [0.22,0.56,0.22];
deltaY = [0,0,0];
%loss = hpof(pitheta0 ,deltaY ,epsilon,advantage ,oldp );
oneslike = ones(1,length(oldp));
%psum = pitheta*oneslike'
fun = @(pitheta)[hpof(pitheta ,[0,0,0] ,epsilon,advantage ,oldp,advw );hpof(pitheta ,[1,0,0] ,epsilon,advantage ,oldp,advw);hpof(pitheta ,[0,1,0],epsilon,advantage ,oldp,advw );hpof(pitheta ,[0,0,1] ,epsilon,advantage ,oldp,advw )];
%constrpi:pitheta*oneslike'
%x= fminimax(fun,x0,A,b,Aeq,beq,lb,ub)
% Ax<=b
% Aeqx =beq
% ub>=x>=lb
lb = [0,0,0];
ub = [1,1,1];
%x0 = [0.18,0.6,0.22];
%x0 = [0.2,0.6,0.2];
x0 = [0.18,0.6,0.2];
%x0 = oldp
A = []; % No linear constraints
b = [];
Aeq = ones(1,length(oldp));
% Aeq = [];
beq = [1];
% beq = [];
deltaY = [1,0,0];
loss = hpof(x0 ,deltaY ,epsilon,advantage ,oldp,advw )
%[x,fval] = fminimax(fun,oldp,A,b,Aeq,beq,lb,ub)
[x,fval] = fminimax(fun,x0,A,b,Aeq,beq,lb,ub)
%loss = hpof(pitheta(2),deltaY(2),epsilon,advantage(2),oldp(2))
%[x,fval,maxfval,exitflag,output] = fminimax(___)